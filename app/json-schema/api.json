{
    "$schema": "http://json-schema.org/draft-04/schema$",
    "title": "API specification of Ahvoda",
    "description": "Fully describes the API for interacting with the Ahvoda backend over HTTP.",
    "root": {
        "type": "directory",
        "contents": {
            "data": {
                "type": "directory",
                "contents": {
                    "gender": {
                        "type": "directory",
                        "contents": {
                            "collection": {
                                "type": "endpoint",
                                "url": "/api/data/genders",
                                "description": "Collection of genders.",
                                "verbs": {
                                    "GET": {
                                        "accountTypes": [ "employee", "manager" ],
                                        "responses": {
                                            "200": {
                                                "type": "array",
                                                "items": {
                                                    "$ref": "definitions/gender.json"
                                                }
                                            }
                                        }
                                    }
                                }
                            },
                            "instance": {
                                "type": "endpoint",
                                "url": "/api/data/genders/<int:gender_id>",
                                "description": "Instance of a gender.",
                                "verbs": {
                                    "GET": {
                                        "accountTypes": [ "employee", "manager" ],
                                        "responses": {
                                            "200": {
                                                "$ref": "definitions/gender.json"
                                            },
                                            "404": {
                                                "$ref": "#/errors/message"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "country": {
                        "type": "directory",
                        "contents": {
                            "collection": {
                                "type": "endpoint",
                                "url": "/api/data/countries",
                                "description": "Collection of countries.",
                                "verbs": {
                                    "GET": {
                                        "accountTypes": [ "employee", "manager" ],
                                        "responses": {
                                            "200": {
                                                "type": "array",
                                                "items": {
                                                    "$ref": "definitions/country.json"
                                                }
                                            }
                                        }
                                    }
                                }
                            },
                            "instance": {
                                "type": "endpoint",
                                "url": "/api/data/countries/<int:country_id>",
                                "description": "An instance of a country.",
                                "verbs": {
                                    "GET": {
                                        "accountTypes": [ "employee", "manager" ],
                                        "responses": {
                                            "200": {
                                                "$ref": "definitions/country.json"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "state": {
                        "type": "directory",
                        "contents": {
                            "collection": {
                                "type": "endpoint",
                                "url": "/api/data/states",
                                "description": "Collection of states.",
                                "verbs": {
                                    "GET": {
                                        "accountTypes": [ "employee", "manager" ],
                                        "query_string": {
                                            "type": "object",
                                            "properties": {
                                                "country_id": {
                                                    "type": "string"
                                                }
                                            },
                                            "additionalProperties": false
                                        },
                                        "responses": {
                                            "200": {
                                                "type": "array",
                                                "items": {
                                                    "$ref": "definitions/state.json"
                                                }
                                            },
                                            "404": {
                                                "$ref": "#/errors/message"
                                            }
                                        }
                                    }
                                }
                            },
                            "instance": {
                                "type": "endpoint",
                                "url": "/api/data/states/<int:state_id>",
                                "description": "Instance of a state.",
                                "verbs": {
                                    "GET": {
                                        "accountTypes": [ "employee", "manager" ],
                                        "responses": {
                                            "200": {
                                                "$ref": "definitions/state.json"
                                            },
                                            "404": {
                                                "$ref": "#/errors/message"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "city": {
                        "type": "directory",
                        "contents": {
                            "collection": {
                                "type": "endpoint",
                                "url": "/api/data/cities",
                                "description": "Collection of cities.",
                                "verbs": {
                                    "GET": {
                                        "accountTypes": [ "employee", "manager" ],
                                        "responses": {
                                            "200": {
                                                "type": "array",
                                                "items": {
                                                    "$ref": "definitions/city.json"
                                                }
                                            }
                                        }
                                    }
                                }
                            },
                            "instance": {
                                "type": "endpoint",
                                "url": "/api/data/cities/<int:city_id>",
                                "description": "Instance of a city.",
                                "verbs": {
                                    "GET": {
                                        "accountTypes": [ "employee", "manager" ],
                                        "responses": {
                                            "200": {
                                                "$ref": "definitions/city.json"
                                            },
                                            "404": {
                                                "$ref": "#/errors/message"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "language": {
                        "type": "directory",
                        "contents": {
                            "collection": {
                                "type": "endpoint",
                                "url": "/api/data/languages",
                                "description": "Collection of languages.",
                                "verbs": {
                                    "GET": {
                                        "accountTypes": [ "employee", "manager" ],
                                        "responses": {
                                            "200": {
                                                "type": "array",
                                                "items": {
                                                    "$ref": "definitions/language.json"
                                                }
                                            }
                                        }
                                    }
                                }
                            },
                            "instance": {
                                "type": "endpoint",
                                "url": "/api/data/languages/<iso_name>",
                                "description": "Instance of a language.",
                                "verbs": {
                                    "GET": {
                                        "accountTypes": [ "employee", "manager" ],
                                        "responses": {
                                            "200": {
                                                "$ref": "definitions/language.json"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            },
            "device": {
                "type": "directory",
                "contents": {
                    "collection": {
                        "type": "endpoint",
                        "url": "/api/devices",
                        "description": "Collection of devices.",
                        "verbs": {
                            "GET": {
                                "accountTypes": [ "administrator" ],
                                "responses": {
                                    "200": {
                                        "type": "array",
                                        "items": {
                                            "$ref": "definitions/device.json"
                                        }
                                    }
                                }
                            },
                            "POST": {
                                "accountTypes": [ "employee", "manager" ],
                                "request": {
                                    "type": "object",
                                    "properties": {
                                        "username": {
                                            "type": "string"
                                        },
                                        "reg": {
                                            "type": "string"
                                        }
                                    },
                                    "required": [ "username", "reg" ],
                                    "additionalProperties": false
                                },
                                "responses": {
                                    "200": {
                                        "$ref": "definitions/device.json"
                                    },
                                    "400": {
                                        "$ref": "#/errors/message"
                                    },
                                    "403": {
                                        "$ref": "#/errors/message"
                                    },
                                    "404": {
                                        "$ref": "#/errors/message"
                                    }
                                }
                            }
                        }
                    }
                }
            },
            "manager": {
                "type": "directory",
                "contents": {
                    "collection": {
                        "type": "endpoint",
                        "url": "/api/managers",
                        "description": "Collection of managers.",
                        "verbs": {
                            "GET": {
                                "accountTypes": [ "administrator" ],
                                "responses": {
                                    "200": {
                                        "type": "array",
                                        "items": {
                                            "$ref": "definitions/manager.json"
                                        }
                                    }
                                }
                            },
                            "POST": {
                                "accountTypes": [ "administrator" ],
                                "request": {
                                    "type": "object",
                                    "properties": {
                                        "username": { "type": "string" },
                                        "password": { "type": "string" },
                                        "first_name": { "type": "string" },
                                        "last_name": { "type": "string" },
                                        "gender_id": {
                                            "$ref": "definitions/id.json"
                                        },
                                        "birth_date": {
                                            "type": "string",
                                            "format": "date"
                                        },
                                        "email_address": {
                                            "type": "string",
                                            "format": "email"
                                        },
                                        "phone_number": {
                                            "$ref": "definitions/phone_number.json"
                                        }
                                    },
                                    "required": [
                                        "username",
                                        "password",
                                        "first_name",
                                        "last_name",
                                        "gender_id",
                                        "birth_date",
                                        "email_address",
                                        "phone_number"
                                    ],
                                    "additionalProperties": false
                                },
                                "responses": {
                                    "200": {
                                        "$ref": "definitions/manager.json"
                                    },
                                    "400": {
                                        "$ref": "#/errors/message"
                                    },
                                    "403": {
                                        "$ref": "#/errors/message"
                                    },
                                    "404": {
                                        "$ref": "#/errors/message"
                                    }
                                }
                            }
                        }
                    },
                    "instance": {
                        "type": "endpoint",
                        "url": "/api/managers/<manager_username>",
                        "description": "An instance of a manager.",
                        "verbs": {
                            "GET": {
                                "accountTypes": [ "manager" ],
                                "responses": {
                                    "200": {
                                        "$ref": "definitions/manager.json"
                                    },
                                    "404": {
                                        "$ref": "#/errors/message"
                                    }
                                }
                            },
                            "DELETE": {
                                "accountTypes": [ "administrator" ],
                                "responses": {
                                    "204": {},
                                    "404": {
                                        "$ref": "#/errors/message"
                                    }
                                }
                            }
                        }
                    },
                    "business": {
                        "type": "directory",
                        "contents": {
                            "collection": {
                                "type": "endpoint",
                                "description": "Manage the businesses managed by a manager.",
                                "url": "/api/managers/<manager_name>/businesses",
                                "verbs": {
                                    "GET": {
                                        "accountTypes": [ "manager" ],
                                        "responses": {
                                            "200": {
                                                "type": "array",
                                                "items": {
                                                    "$ref": "definitions/business.json"
                                                }
                                            },
                                            "404": {
                                                "$ref": "#/errors/message"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            },
            "listings": {
                "type": "endpoint",
                "url": "/api/listings",
                "description": "Global readonly collection of listings.",
                "verbs": {
                    "GET": {
                        "accountTypes": [ "employee", "manager" ],
                        "query_string": {
                            "type": "object",
                            "properties": {
                                "status": { "$ref": "definitions/job_status_name.json" },
                                "since": { "$ref": "definitions/date_time.json" },
                                "before": { "$ref": "definitions/date_time.json" },
                                "max": { "type": "string" },
                                "created_by": {
                                    "description": "Username of the manager that created the listing.",
                                    "type": "string"
                                },
                                "business": { "type": "string" },
                                "dispatched_to": {
                                    "description": "Username of the employee receiving the listing.",
                                    "type": "string"
                                },
                                "worked_by": {
                                    "description": "Username of the employee associated with the listing.",
                                    "type": "string"
                                }
                            },
                            "additionalProperties": false
                        },
                        "responses": {
                            "200": {
                                "type": "array",
                                "items": {
                                    "$ref": "definitions/listing.json"
                                }
                            },
                            "400": { "$ref": "#/errors/message" },
                            "403": { "$ref": "#/errors/message" },
                            "404": { "$ref": "#/errors/message" }
                        }
                    }
                }
            },
            "employee": {
                "type": "directory",
                "contents": {
                    "collection": {
                        "type": "endpoint",
                        "url": "/api/employees",
                        "description": "Collection of employees.",
                        "verbs": {
                            "GET": {
                                "accountTypes": [ "administrator" ],
                                "responses": {
                                    "200": {
                                        "type": "array",
                                        "items": {
                                            "$ref": "definitions/employee.json"
                                        }
                                    },
                                    "404": {
                                        "$ref": "#/errors/message"
                                    }
                                }
                            },
                            "POST": {
                                "accountTypes": [ "administrator" ],
                                "request": {
                                    "type": "object",
                                    "properties": {
                                        "username": { "type": "string" },
                                        "password": { "type": "string" },
                                        "first_name": { "type": "string" },
                                        "last_name": { "type": "string" },
                                        "gender_id": {
                                            "$ref": "definitions/id.json"
                                        },
                                        "birth_date": {
                                            "type": "string",
                                            "format": "date"
                                        },
                                        "email_address": {
                                            "type": "string",
                                            "format": "email"
                                        },
                                        "phone_number": {
                                            "$ref": "definitions/phone_number.json"
                                        },
                                        "postal_code": {
                                            "type": "string",
                                            "format": "postal-code"
                                        },
                                        "address": {
                                            "type": "string"
                                        },
                                        "city_id": {
                                            "$ref": "definitions/id.json"
                                        },
                                        "languages": {
                                            "type": "array",
                                            "items": {
                                                "$ref": "definitions/language.json"
                                            }
                                        }
                                    },
                                    "required": [
                                        "username",
                                        "password",
                                        "first_name",
                                        "last_name",
                                        "gender_id",
                                        "birth_date",
                                        "email_address",
                                        "postal_code",
                                        "phone_number",
                                        "address",
                                        "city_id",
                                        "languages"
                                    ],
                                    "additionalProperties": false
                                },
                                "responses": {
                                    "200": {
                                        "$ref": "definitions/employee.json"
                                    },
                                    "400": {
                                        "$ref": "#/errors/message"
                                    },
                                    "404": {
                                        "$ref": "#/errors/message"
                                    }
                                }
                            }
                        }
                    },
                    "instance": {
                        "type": "endpoint",
                        "description": "Detailed information about an employee.",
                        "url": "/api/employees/<employee_name>",
                        "verbs": {
                            "GET": {
                                "accountTypes": [ "employee", "manager" ],
                                "responses": {
                                    "200": {
                                        "$ref": "definitions/employee.json"
                                    },
                                    "403": {
                                        "$ref": "#/errors/message"
                                    },
                                    "404": {
                                        "$ref": "#/errors/message"
                                    }
                                }
                            },
                            "PATCH": {
                                "accountTypes": [ "employee" ],
                                "request": {
                                    "$ref": "definitions/employee.json"
                                },
                                "responses": {
                                    "204": {},
                                    "400": {
                                        "$ref": "#/errors/message"
                                    },
                                    "403": {
                                        "$ref": "#/errors/message"
                                    }
                                }
                            }
                        }
                    },
                    "location": {
                        "type": "endpoint",
                        "description": "The current 'flag' location of an employee.",
                        "url": "/api/employees/<employee_name>/location",
                        "verbs": {
                            "GET": {
                                "accountTypes": [ "employee", "manager" ],
                                "responses": {
                                    "200": {
                                        "$ref": "definitions/location.json"
                                    },
                                    "404": {
                                        "$ref": "#/errors/message"
                                    }
                                }
                            },
                            "PUT": {
                                "accountTypes": [ "employee" ],
                                "request": {
                                    "$ref": "definitions/location.json"
                                },
                                "responses": {
                                    "204": {},
                                    "400": {
                                        "$ref": "definitions/location.json"
                                    },
                                    "404": {
                                        "$ref": "#/errors/message"
                                    }
                                }
                            }
                        }
                    }
                }
            },
            "business": {
                "type": "directory",
                "contents": {
                    "instance": {
                        "type": "endpoint",
                        "url": "/api/businesses/<int:business_id>",
                        "description": "Detailed information about a business.",
                        "verbs": {
                            "GET": {
                                "accountTypes": [ "employee", "manager" ],
                                "responses": {
                                    "200": {
                                        "$ref": "definitions/business.json"
                                    },
                                    "403": {
                                        "$ref": "#/errors/message"
                                    },
                                    "404": {
                                        "$ref": "#/errors/message"
                                    }
                                }
                            },
                            "PATCH": {
                                "accountTypes": [ "manager" ],
                                "request": {
                                    "$ref": "definitions/business.json"
                                },
                                "responses": {
                                    "204": {},
                                    "403": {
                                        "$ref": "#/errors/message"
                                    },
                                    "404": {
                                        "$ref": "#/errors/message"
                                    }
                                }
                            },
                            "DELETE": {
                                "accountTypes": [ "administrator" ],
                                "responses": {
                                    "204": {},
                                    "404": {
                                        "$ref": "#/errors/message"
                                    }
                                }
                            }
                        }
                    },
                    "collection": {
                        "type": "endpoint",
                        "url": "/api/businesses",
                        "description": "Collection of businesses.",
                        "verbs": {
                            "GET": {
                                "accountTypes": [ "administrator" ],
                                "responses": {
                                    "200": {
                                        "type": "array",
                                        "items": {
                                            "$ref": "definitions/business.json"
                                        }
                                    }
                                }
                            },
                            "POST": {
                                "accountTypes": [ "administrator" ],
                                "request": {
                                    "type": "object",
                                    "properties": {
                                        "name": { "type": "string" },
                                        "description": { "type": "string" },
                                        "fixed_location": {
                                            "type": "object",
                                            "properties": {
                                                "address": { "type": "string" },
                                                "city_id": { "$ref": "definitions/id.json" },
                                                "postal_code": {
                                                    "type": "string",
                                                    "format": "postal-code"
                                                }
                                            },
                                            "required": [ "address", "city_id" ],
                                            "additionalProperties": false
                                        },
                                        "contact_info": {
                                            "type": "object",
                                            "properties": {
                                                "email_address": {
                                                    "type": "string",
                                                    "format": "email"
                                                },
                                                "phone_number": {
                                                    "$ref": "definitions/phone_number.json"
                                                }
                                            },
                                            "required": [ "email_address", "phone_number" ],
                                            "additionalProperties": false
                                        },
                                        "languages": {
                                            "type": "array",
                                            "minItems": 1,
                                            "items": {
                                                "$ref": "definitions/language.json"
                                            }
                                        }
                                    },
                                    "required": [
                                        "name",
                                        "description",
                                        "fixed_location",
                                        "contact_info",
                                        "languages"
                                    ],
                                    "additionalProperties": false
                                },
                                "responses": {
                                    "200": {
                                        "$ref": "definitions/business.json"
                                    },
                                    "403": { "$ref": "#/errors/message" }
                                }
                            }
                        }
                    },
                    "manager": {
                        "type": "directory",
                        "contents": {
                            "collection": {
                                "type": "endpoint",
                                "url": "/api/businesses/<int:business_id>/managers",
                                "description": "Collection of managers at a business.",
                                "verbs": {
                                    "GET": {
                                        "accountTypes": [ "employee", "manager" ],
                                        "responses": {
                                            "200": {
                                                "type": "array",
                                                "items": {
                                                    "$ref": "definitions/manager.json"
                                                }
                                            },
                                            "404": {
                                                "$ref": "#/errors/message"
                                            }
                                        }
                                    },
                                    "POST": {
                                        "accountTypes": [ "manager" ],
                                        "request": {
                                            "type": "object",
                                            "properties": {
                                                "name": { "type": "string" },
                                                "required": [ "name" ],
                                                "additionalProperties": false
                                            }
                                        },
                                        "responses": {
                                            "200": {
                                                "$ref": "definitions/business.json"
                                            },
                                            "400": {
                                                "$ref": "#/errors/message"
                                            },
                                            "404": {
                                                "$ref": "#/errors/message"
                                            }
                                        }
                                    }
                                }
                            },
                            "instance": {
                                "type": "endpoint",
                                "url": "/api/businesses/<int:business_id>/managers/<manager_name>",
                                "description": "Instance of a manager at a business.",
                                "verbs": {
                                    "DELETE": {
                                        "accountTypes": [ "manager" ],
                                        "responses": {
                                            "204": {},
                                            "404": {
                                                "$ref": "#/errors/message"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "position": {
                        "type": "directory",
                        "contents": {
                            "collection": {
                                "type": "endpoint",
                                "url": "/api/businesses/<int:business_id>/positions",
                                "description": "Create a new position.",
                                "verbs": {
                                    "POST": {
                                        "accountTypes": [ "manager" ],
                                        "request": {
                                            "type": "object",
                                            "properties": {
                                                "name": {
                                                    "type": "string"
                                                },
                                                "default_pay": {
                                                    "$ref": "definitions/salary.json"
                                                },
                                                "default_details": {
                                                    "type": "string"
                                                },
                                                "default_languages": {
                                                    "type": "array",
                                                    "items": {
                                                        "$ref": "definitions/language.json"
                                                    },
                                                    "minItems": 1
                                                }
                                            },
                                            "required": [
                                                "name",
                                                "default_pay",
                                                "default_details",
                                                "default_languages"
                                            ],
                                            "additionalProperties": false
                                        },
                                        "responses": {
                                            "200": {
                                                "$ref": "definitions/position.json"
                                            },
                                            "400": { "$ref": "#/errors/message" },
                                            "403": { "$ref": "#/errors/message" },
                                            "404": { "$ref": "#/errors/message" }
                                        }
                                    },
                                    "GET": {
                                        "accountTypes": [ "manager" ],
                                        "responses": {
                                            "200": {
                                                "type": "array",
                                                "items": {
                                                    "$ref": "definitions/position.json"
                                                }
                                            },
                                            "403": { "$ref": "#/errors/message" },
                                            "404": { "$ref": "#/errors/message" }
                                        }
                                    }
                                }
                            },
                            "instance": {
                                "type": "endpoint",
                                "url": "/api/businesses/<int:business_id>/positions/<int:position_id>",
                                "description": "Instance of a single position within a business.",
                                "verbs": {
                                    "GET": {
                                        "accountTypes": [ "manager" ],
                                        "responses": {
                                            "200": {
                                                "$ref": "definitions/position.json"
                                            },
                                            "403": {
                                                "$ref": "#/errors/message"
                                            },
                                            "404": {
                                                "$ref": "#/errors/message"
                                            }
                                        }
                                    },
                                    "PATCH": {
                                        "accountTypes": [ "manager" ],
                                        "request": {
                                            "type": "object",
                                            "properties": {
                                                "name": {
                                                    "type": "string"
                                                }
                                            },
                                            "additionalProperties": false
                                        },
                                        "responses": {
                                            "204": {},
                                            "400": {
                                                "$ref": "#/errors/message"
                                            },
                                            "403": {
                                                "$ref": "#/errors/message"
                                            },
                                            "404": {
                                                "$ref": "#/errors/message"
                                            }
                                        }
                                    },
                                    "DELETE": {
                                        "accountTypes": [ "manager" ],
                                        "responses": {
                                            "204": {},
                                            "403": {
                                                "$ref": "#/errors/message"
                                            },
                                            "404": {
                                                "$ref": "#/errors/message"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "listing": {
                        "type": "directory",
                        "contents": {
                            "instance": {
                                "type": "endpoint",
                                "url":
                                "/api/businesses/<int:business_id>/listings/<int:listing_id>",
                                "description": "Detailed information about a listing.",
                                "verbs": {
                                    "GET": {
                                        "accountTypes": [ "employee", "manager" ],
                                        "responses": {
                                            "200": { "$ref": "definitions/listing.json" },
                                            "403": { "$ref": "#/errors/message" },
                                            "404": { "$ref": "#/errors/message" }
                                        }
                                    },
                                    "PATCH": {
                                        "accountTypes": [ "manager" ],
                                        "request": {
                                            "$ref": "definitions/listing_request.json"
                                        },
                                        "responses": {
                                            "204": {},
                                            "400": { "$ref": "#/errors/message" },
                                            "403": { "$ref": "#/errors/message" },
                                            "404": { "$ref": "#/errors/message" },
                                            "409": { "$ref": "#/errors/message" }
                                        }
                                    },
                                    "DELETE": {
                                        "accountTypes": [ "manager" ],
                                        "responses": {
                                            "204": {},
                                            "400": { "$ref": "#/errors/message" },
                                            "403": { "$ref": "#/errors/message" },
                                            "404": { "$ref": "#/errors/message" },
                                            "409": { "$ref": "#/errors/message" }
                                        }
                                    }
                                }
                            },
                            "apply": {
                                "type": "endpoint",
                                "description": "Apply to a job.",
                                "url": "/api/businesses/<int:business_id>/listings/<int:listing_id>/applicants",
                                "verbs": {
                                    "POST": {
                                        "accountTypes": [ "employee" ],
                                        "request": {
                                            "type": "object",
                                            "properties": {
                                                "name": { "type": "string" }
                                            },
                                            "required": [ "name" ],
                                            "additionalProperties": "false"
                                        },
                                        "responses": {
                                            "200": {
                                                "$ref": "definitions/listing.json"
                                            },
                                            "400": {
                                                "$ref": "#/errors/message"
                                            },
                                            "403": {
                                                "$ref": "#/errors/message"
                                            },
                                            "404": {
                                                "$ref": "#/errors/message"
                                            },
                                            "409": {
                                                "$ref": "#/errors/message"
                                            }
                                        }
                                    },
                                    "GET": {
                                        "accountTypes": [ "manager" ],
                                        "responses": {
                                            "200": {
                                                "type": "array",
                                                "items": {
                                                    "$ref": "definitions/employee.json"
                                                }
                                            },
                                            "404": {
                                                "$ref": "#/errors/message"
                                            }
                                        }
                                    }
                                }
                            },
                            "employee": {
                                "type": "directory",
                                "contents": {
                                    "arrival": {
                                        "type": "endpoint",
                                        "url": "/api/businesses/<int:business_id>/listings/<int:listing_id>/employee/arrival",
                                        "description": "The arrival time of an employee.",
                                        "verbs": {
                                            "POST": {
                                                "accountTypes": [ "manager" ],
                                                "request": {
                                                    "type": "object",
                                                    "properties": {
                                                        "time": {
                                                            "$ref": "definitions/date_time.json"
                                                        }
                                                    },
                                                    "required": [ "time" ],
                                                    "additinalProperties": false
                                                },
                                                "responses": {
                                                    "200": {
                                                        "$ref": "definitions/listing.json"
                                                    },
                                                    "400": {
                                                        "$ref": "#/errors/message"
                                                    },
                                                    "403": {
                                                        "$ref": "#/errors/message"
                                                    },
                                                    "404": {
                                                        "$ref": "#/errors/message"
                                                    },
                                                    "409": {
                                                        "$ref": "#/errors/message"
                                                    }
                                                }
                                            }
                                        }
                                    },
                                    "departure": {
                                        "type": "endpoint",
                                        "url": "/api/businesses/<int:business_id>/listings/<int:listing_id>/employee/departure",
                                        "description": "The departure time of an employee.",
                                        "verbs": {
                                            "POST": {
                                                "accountTypes": [ "manager" ],
                                                "request": {
                                                    "type": "object",
                                                    "properties": {
                                                        "time": {
                                                            "$ref": "definitions/date_time.json"
                                                        }
                                                    },
                                                    "required": [ "time" ],
                                                    "additinalProperties": false
                                                },
                                                "responses": {
                                                    "200": {
                                                        "$ref": "definitions/listing.json"
                                                    },
                                                    "400": {
                                                        "$ref": "#/errors/message"
                                                    },
                                                    "403": {
                                                        "$ref": "#/errors/message"
                                                    },
                                                    "404": {
                                                        "$ref": "#/errors/message"
                                                    },
                                                    "409": {
                                                        "$ref": "#/errors/message"
                                                    }
                                                }
                                            }
                                        }
                                    },
                                    "approve": {
                                        "type": "endpoint",
                                        "url": "/api/businesses/<int:business_id>/listings/<int:listing_id>/employee",
                                        "description": "The employee selected for the job.",
                                        "verbs": {
                                            "POST": {
                                                "accountTypes": [ "manager" ],
                                                "request": {
                                                    "type": "object",
                                                    "properties": {
                                                        "name": {
                                                            "type": "string"
                                                        }
                                                    },
                                                    "required": [ "name" ],
                                                    "additionalProperties": false
                                                },
                                                "responses": {
                                                    "200": {
                                                        "$ref": "definitions/listing.json"
                                                    },
                                                    "400": {
                                                        "$ref": "#/errors/message"
                                                    },
                                                    "403": {
                                                        "$ref": "#/errors/message"
                                                    },
                                                    "404": {
                                                        "$ref": "#/errors/message"
                                                    },
                                                    "409": {
                                                        "$ref": "#/errors/message"
                                                    }
                                                }
                                            },
                                            "GET": {
                                                "accountTypes": [ "manager" ],
                                                "responses": {
                                                    "200": {
                                                        "$ref": "definitions/employee.json"
                                                    },
                                                    "403": {
                                                        "$ref": "#/errors/message"
                                                    },
                                                    "404": {
                                                        "$ref": "#/errors/message"
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            },
                            "collection": {
                                "type": "endpoint",
                                "url": "/api/businesses/<int:business_id>/listings",
                                "description": "Collection of listings.",
                                "verbs": {
                                    "GET": {
                                        "accountTypes": [ "employee", "manager" ],
                                        "responses": {
                                            "200": {
                                                "type": "array",
                                                "items": {
                                                    "$ref": "definitions/listing.json"
                                                }
                                            },
                                            "403": { "$ref": "#/errors/message" },
                                            "404": { "$ref": "#/errors/message" }
                                        }
                                    },
                                    "POST": {
                                        "accountTypes": [ "manager" ],
                                        "request": {
                                            "allOf": [
                                                { "$ref": "definitions/listing_request.json" },
                                                { "$ref": "definitions/listing_request_req.json" }
                                            ]
                                        },
                                        "responses": {
                                            "202": {
                                                "$ref": "definitions/listing.json"
                                            },
                                            "403": { "$ref": "#/errors/message" },
                                            "404": { "$ref": "#/errors/message" }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    },
    "errors": {
        "message": {
            "type": "object",
            "properties": {
                "message": {
                    "type": "string"
                }
            },
            "additionalProperties": true,
            "required": [ "message" ]
        }
    }
}
