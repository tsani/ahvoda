{
    "$schema": "http://json-schema.org/draft-04/schema$",
    "title": "API specification of Ahvoda",
    "description": "Fully describes the API for interacting with the Ahvoda backend over HTTP.",
    "root": {
        "type": "directory",
        "contents": {
            "data": {
                "type": "directory",
                "contents": {
                    "gender": {
                        "type": "directory",
                        "contents": {
                            "collection": {
                                "type": "endpoint",
                                "url": "/api/data/genders",
                                "description": "Collection of genders.",
                                "verbs": {
                                    "GET": {
                                        "accountTypes": [ "employee", "manager" ],
                                        "responses": {
                                            "200": {
                                                "type": "object",
                                                "properties": {
                                                    "genders": {
                                                        "type": "array",
                                                        "items": {
                                                            "$ref": "#/definitions/gender"
                                                        }
                                                    }
                                                },
                                                "required": [ "genders" ],
                                                "additionalProperties": false
                                            }
                                        }
                                    }
                                }
                            },
                            "instance": {
                                "type": "endpoint",
                                "url": "/api/data/genders/<int:gender_id>",
                                "description": "Instance of a gender.",
                                "verbs": {
                                    "GET": {
                                        "accountTypes": [ "employee", "manager" ],
                                        "responses": {
                                            "200": {
                                                "$ref": "#/definitions/gender"
                                            },
                                            "404": {
                                                "$ref": "#/errors/message"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "country": {
                        "type": "directory",
                        "contents": {
                            "collection": {
                                "type": "endpoint",
                                "url": "/api/data/countries",
                                "description": "Collection of countries.",
                                "verbs": {
                                    "GET": {
                                        "accountTypes": [ "employee", "manager" ],
                                        "responses": {
                                            "200": {
                                                "type": "object",
                                                "properties": {
                                                    "countries": {
                                                        "type": "array",
                                                        "items": {
                                                            "$ref": "#/definitions/country"
                                                        }
                                                    }
                                                },
                                                "required": [ "countries" ],
                                                "additionalProperties": false
                                            }
                                        }
                                    }
                                }
                            },
                            "instance": {
                                "type": "endpoint",
                                "url": "/api/data/countries/<int:country_id>",
                                "description": "An instance of a country.",
                                "verbs": {
                                    "GET": {
                                        "accountTypes": [ "employee", "manager" ],
                                        "responses": {
                                            "200": {
                                                "$ref": "#/definitions/country"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "state": {
                        "type": "directory",
                        "contents": {
                            "collection": {
                                "type": "endpoint",
                                "url": "/api/data/states",
                                "description": "Collection of states.",
                                "verbs": {
                                    "GET": {
                                        "accountTypes": [ "employee", "manager" ],
                                        "query_string": {
                                            "type": "object",
                                            "properties": {
                                                "country_id": {
                                                    "$ref": "#/definitions/id"
                                                }
                                            },
                                            "additionalProperties": false
                                        },
                                        "responses": {
                                            "200": {
                                                "type": "object",
                                                "properties": {
                                                    "states": {
                                                        "type": "array",
                                                        "items": {
                                                            "$ref": "#/definitions/state"
                                                        }
                                                    }
                                                },
                                                "required": [ "states" ],
                                                "additionalProperties": false
                                            },
                                            "404": {
                                                "$ref": "#/errors/message"
                                            }
                                        }
                                    }
                                }
                            },
                            "instance": {
                                "type": "endpoint",
                                "url": "/api/data/states/<int:state_id>",
                                "description": "Instance of a state.",
                                "verbs": {
                                    "GET": {
                                        "accountTypes": [ "employee", "manager" ],
                                        "responses": {
                                            "200": {
                                                "$ref": "#/definitions/state"
                                            },
                                            "404": {
                                                "$ref": "#/errors/message"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "city": {
                        "type": "directory",
                        "contents": {
                            "collection": {
                                "type": "endpoint",
                                "url": "/api/data/cities",
                                "description": "Collection of cities.",
                                "verbs": {
                                    "GET": {
                                        "accountTypes": [ "employee", "manager" ],
                                        "responses": {
                                            "200": {
                                                "type": "object",
                                                "properties": {
                                                    "cities": {
                                                        "type": "array",
                                                        "items": {
                                                            "$ref": "#/definitions/city"
                                                        }
                                                    }
                                                },
                                                "required": [ "cities" ],
                                                "additionalProperties": false
                                            }
                                        }
                                    }
                                }
                            },
                            "instance": {
                                "type": "endpoint",
                                "url": "/api/data/cities/<int:city_id>",
                                "description": "Instance of a city.",
                                "verbs": {
                                    "GET": {
                                        "accountTypes": [ "employee", "manager" ],
                                        "responses": {
                                            "200": {
                                                "$ref": "#/definitions/city"
                                            },
                                            "404": {
                                                "$ref": "#/errors/message"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "language": {
                        "type": "directory",
                        "contents": {
                            "collection": {
                                "type": "endpoint",
                                "url": "/api/data/languages",
                                "description": "Collection of languages.",
                                "verbs": {
                                    "GET": {
                                        "accountTypes": [ "employee", "manager" ],
                                        "responses": {
                                            "200": {
                                                "type": "object",
                                                "properties": {
                                                    "languages": {
                                                        "type": "array",
                                                        "items": {
                                                            "$ref": "#/definitions/language"
                                                        }
                                                    }
                                                },
                                                "required": [ "languages" ],
                                                "additionalProperties": false
                                            }
                                        }
                                    }
                                }
                            },
                            "instance": {
                                "type": "endpoint",
                                "url": "/api/data/languages/<iso_name>",
                                "description": "Instance of a language.",
                                "verbs": {
                                    "GET": {
                                        "accountTypes": [ "employee", "manager" ],
                                        "responses": {
                                            "200": {
                                                "$ref": "#/definitions/language"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            },
            "manager": {
                "type": "directory",
                "contents": {
                    "collection": {
                        "type": "endpoint",
                        "url": "/api/managers",
                        "description": "Collection of managers.",
                        "verbs": {
                            "GET": {
                                "accountTypes": [ "administrator" ],
                                "responses": {
                                    "200": {
                                        "type": "object",
                                        "properties": {
                                            "managers": {
                                                "type": "array",
                                                "items": {
                                                    "$ref": "#/definitions/manager"
                                                }
                                            }
                                        },
                                        "required": [ "managers" ],
                                        "additionalProperties": false
                                    }
                                }
                            },
                            "POST": {
                                "accountTypes": [ "administrator" ],
                                "request": {
                                    "type": "object",
                                    "properties": {
                                        "username": { "type": "string" },
                                        "password": { "type": "string" },
                                        "first_name": { "type": "string" },
                                        "last_name": { "type": "string" },
                                        "gender_id": {
                                            "$ref": "#/definitions/id"
                                        },
                                        "birth_date": {
                                            "type": "string",
                                            "format": "date"
                                        },
                                        "email_address": {
                                            "type": "string",
                                            "format": "email"
                                        },
                                        "phone_number": {
                                            "type": "string",
                                            "format": "phone"
                                        }
                                    },
                                    "required": [
                                        "username",
                                        "password",
                                        "first_name",
                                        "last_name",
                                        "gender_id",
                                        "birth_date",
                                        "email_address",
                                        "phone_number"
                                    ],
                                    "additionalProperties": false
                                },
                                "responses": {
                                    "200": {
                                        "$ref": "#/definitions/manager"
                                    },
                                    "400": {
                                        "$ref": "#/errors/message"
                                    },
                                    "403": {
                                        "$ref": "#/errors/message"
                                    },
                                    "404": {
                                        "$ref": "#/errors/message"
                                    }
                                }
                            }
                        }
                    },
                    "instance": {
                        "type": "endpoint",
                        "url": "/api/managers/<manager_username>",
                        "description": "An instance of a manager.",
                        "verbs": {
                            "GET": {
                                "accountTypes": [ "manager" ],
                                "responses": {
                                    "200": {
                                        "$ref": "#/definitions/manager"
                                    },
                                    "404": {
                                        "$ref": "#/errors/message"
                                    }
                                }
                            },
                            "DELETE": {
                                "accountTypes": [ "administrator" ],
                                "responses": {
                                    "204": {},
                                    "404": {
                                        "$ref": "#/errors/message"
                                    }
                                }
                            }
                        }
                    },
                    "business": {
                        "type": "directory",
                        "contents": {
                            "collection": {
                                "type": "endpoint",
                                "description": "Manage the businesses managed by a manager.",
                                "url": "/api/managers/<manager_name>/businesses",
                                "verbs": {
                                    "GET": {
                                        "accountTypes": [ "manager" ],
                                        "responses": {
                                            "200": {
                                                "type": "object",
                                                "properties": {
                                                    "businesses": {
                                                        "type": "array",
                                                        "items": {
                                                            "$ref": "#/definitions/business"
                                                        }
                                                    },
                                                    "required": "businesses",
                                                    "additionalProperties": false
                                                }
                                            },
                                            "404": {
                                                "$ref": "#/errors/message"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            },
            "listings": {
                "type": "endpoint",
                "url": "/api/listings",
                "description": "Global readonly collection of listings.",
                "verbs": {
                    "GET": {
                        "accountTypes": [ "employee", "manager" ],
                        "query_string": {
                            "type": "object",
                            "properties": {
                                "status": { "$ref": "#/definitions/job_status_name" },
                                "since": { "$ref": "#/definitions/date_time" },
                                "before": { "$ref": "#/definitions/date_time" },
                                "max": {
                                    "type": "integer",
                                    "minimum": 1
                                },
                                "created_by": {
                                    "description": "Username of the manager that created the listing.",
                                    "type": "string"
                                },
                                "business": { "$ref": "#/definitions/id" },
                                "dispatched_to": {
                                    "description": "Username of the employee receiving the listing.",
                                    "type": "string"
                                },
                                "worked_by": {
                                    "description": "Username of the employee associated with the listing.",
                                    "type": "string"
                                }
                            },
                            "additionalProperties": false
                        },
                        "responses": {
                            "200": {
                                "type": "object",
                                "properties": {
                                    "listings": {
                                        "type": "array",
                                        "items": {
                                            "$ref": "#/definitions/listing"
                                        }
                                    }
                                },
                                "required": [ "listings" ],
                                "additionalProperties": false
                            },
                            "400": { "$ref": "#/errors/message" },
                            "403": { "$ref": "#/errors/message" },
                            "404": { "$ref": "#/errors/message" }
                        }
                    }
                }
            },
            "employee": {
                "type": "directory",
                "contents": {
                    "collection": {
                        "type": "endpoint",
                        "url": "/api/employees",
                        "description": "Collection of employees.",
                        "verbs": {
                            "GET": {
                                "accountTypes": [ "administrator" ],
                                "responses": {
                                    "200": {
                                        "type": "object",
                                        "properties": {
                                            "employees": {
                                                "type": "array",
                                                "items": {
                                                    "$ref": "#/definitions/employee"
                                                }
                                            }
                                        },
                                        "required": [ "employees" ],
                                        "additionalProperties": false
                                    },
                                    "404": {
                                        "$ref": "#/errors/message"
                                    }
                                }
                            },
                            "POST": {
                                "accountTypes": [ "administrator" ],
                                "request": {
                                    "type": "object",
                                    "properties": {
                                        "username": { "type": "string" },
                                        "password": { "type": "string" },
                                        "first_name": { "type": "string" },
                                        "last_name": { "type": "string" },
                                        "gender_id": {
                                            "$ref": "#/definitions/id"
                                        },
                                        "birth_date": {
                                            "type": "string",
                                            "format": "date"
                                        },
                                        "email_address": {
                                            "type": "string",
                                            "format": "email"
                                        },
                                        "phone_number": {
                                            "type": "string",
                                            "format": "phone"
                                        },
                                        "postal_code": {
                                            "type": "string",
                                            "format": "postal-code"
                                        },
                                        "address": {
                                            "type": "string"
                                        },
                                        "city_id": {
                                            "$ref": "#/definitions/id"
                                        },
                                        "languages": {
                                            "type": "array",
                                            "items": {
                                                "$ref": "#/definitions/language"
                                            }
                                        }
                                    },
                                    "required": [
                                        "username",
                                        "password",
                                        "first_name",
                                        "last_name",
                                        "gender_id",
                                        "birth_date",
                                        "email_address",
                                        "postal_code",
                                        "phone_number",
                                        "address",
                                        "city_id",
                                        "languages"
                                    ],
                                    "additionalProperties": false
                                },
                                "responses": {
                                    "200": {
                                        "$ref": "#/definitions/employee"
                                    },
                                    "400": {
                                        "$ref": "#/errors/message"
                                    },
                                    "404": {
                                        "$ref": "#/errors/message"
                                    }
                                }
                            }
                        }
                    },
                    "instance": {
                        "type": "endpoint",
                        "description": "Detailed information about an employee.",
                        "url": "/api/employee/<employee_name>",
                        "verbs": {
                            "GET": {
                                "accountTypes": [ "employee", "manager" ],
                                "responses": {
                                    "200": {
                                        "$ref": "#/definitions/employee"
                                    },
                                    "403": {
                                        "$ref": "#/errors/message"
                                    },
                                    "404": {
                                        "$ref": "#/errors/message"
                                    }
                                }
                            },
                            "PATCH": {
                                "accountTypes": [ "employee" ],
                                "request": {
                                    "$ref": "#/definitions/employee"
                                },
                                "responses": {
                                    "204": {},
                                    "400": {
                                        "$ref": "#/errors/message"
                                    },
                                    "403": {
                                        "$ref": "#/errors/message"
                                    }
                                }
                            }
                        }
                    },
                    "location": {
                        "type": "endpoint",
                        "description": "The current 'flag' location of an employee.",
                        "url": "/api/employee/<employee_name>/location",
                        "verbs": {
                            "GET": {
                                "accountTypes": [ "employee", "manager" ],
                                "responses": {
                                    "200": {
                                        "$ref": "#/definitions/minimalLocation"
                                    },
                                    "404": {
                                        "$ref": "#/errors/message"
                                    }
                                }
                            },
                            "PUT": {
                                "accountTypes": [ "employee" ],
                                "request": {
                                    "$ref": "#/definitions/minimalLocation"
                                },
                                "responses": {
                                    "204": {},
                                    "400": {
                                        "$ref": "#/definitions/minimalLocation"
                                    },
                                    "404": {
                                        "$ref": "#/errors/message"
                                    }
                                }
                            }
                        }
                    }
                }
            },
            "business": {
                "type": "directory",
                "contents": {
                    "instance": {
                        "type": "endpoint",
                        "url": "/api/businesses/<int:business_id>",
                        "description": "Detailed information about a business.",
                        "verbs": {
                            "GET": {
                                "accountTypes": [ "employee", "manager" ],
                                "responses": {
                                    "200": {
                                        "$ref": "#/definitions/business"
                                    },
                                    "403": {
                                        "$ref": "#/errors/message"
                                    },
                                    "404": {
                                        "$ref": "#/errors/message"
                                    }
                                }
                            },
                            "PATCH": {
                                "accountTypes": [ "manager" ],
                                "request": {
                                    "$ref": "#/definitions/business"
                                },
                                "responses": {
                                    "204": {},
                                    "403": {
                                        "$ref": "#/errors/message"
                                    },
                                    "404": {
                                        "$ref": "#/errors/message"
                                    }
                                }
                            }
                        }
                    },
                    "collection": {
                        "type": "endpoint",
                        "url": "/api/businesses",
                        "description": "Collection of businesses.",
                        "verbs": {
                            "GET": {
                                "accountTypes": [ "administrator" ],
                                "responses": {
                                    "200": {
                                        "type": "object",
                                        "properties": {
                                            "businesses": {
                                                "type": "array",
                                                "items": {
                                                    "$ref": "#/definitions/business"
                                                }
                                            },
                                            "required": [ "businesses" ],
                                            "additionalProperties": "false"
                                        }
                                    }
                                }
                            },
                            "POST": {
                                "accountTypes": [ "administrator" ],
                                "request": {
                                    "type": "object",
                                    "properties": {
                                        "name": { "type": "string" },
                                        "description": { "type": "string" },
                                        "location": {
                                            "type": "object",
                                            "properties": {
                                                "address": { "type": "string" },
                                                "city_id": { "$ref": "#/definitions/id" },
                                                "postal_code": {
                                                    "type": "string",
                                                    "format": "postal-code"
                                                }
                                            },
                                            "required": [ "address", "city_id" ],
                                            "additionalProperties": false
                                        },
                                        "contact_info": {
                                            "type": "object",
                                            "properties": {
                                                "email_address": {
                                                    "type": "string",
                                                    "format": "email"
                                                },
                                                "phone_number": {
                                                    "type": "string",
                                                    "format": "phone-number"
                                                }
                                            },
                                            "required": [ "email_address", "phone_number" ],
                                            "additionalProperties": false
                                        },
                                        "languages": {
                                            "type": "array",
                                            "minItems": 1,
                                            "items": {
                                                "$ref": "#/definitions/language"
                                            }
                                        }
                                    },
                                    "required": [
                                        "name",
                                        "description",
                                        "location",
                                        "contact_info",
                                        "languages"
                                    ],
                                    "additionalProperties": false
                                },
                                "responses": {
                                    "200": {
                                        "$ref": "#/definitions/business"
                                    },
                                    "403": { "$ref": "#/errors/message" }
                                }
                            }
                        }
                    },
                    "manager": {
                        "type": "directory",
                        "contents": {
                            "collection": {
                                "type": "endpoint",
                                "url": "/api/businesses/<int:business_id>/managers",
                                "description": "Collection of managers at a business.",
                                "verbs": {
                                    "GET": {
                                        "accountTypes": [ "employee", "manager" ],
                                        "responses": {
                                            "200": {
                                                "type": "object",
                                                "properties": {
                                                    "managers": {
                                                        "type": "array",
                                                        "items": {
                                                            "$ref": "#/definitions/manager"
                                                        }
                                                    },
                                                    "required": [ "managers" ],
                                                    "additionalProperties": false
                                                }
                                            },
                                            "404": {
                                                "$ref": "#/errors/message"
                                            }
                                        }
                                    },
                                    "POST": {
                                        "accountTypes": [ "manager" ],
                                        "request": {
                                            "type": "object",
                                            "properties": {
                                                "name": { "type": "string" },
                                                "required": [ "name" ],
                                                "additionalProperties": false
                                            }
                                        },
                                        "responses": {
                                            "200": {
                                                "$ref": "#/definitions/business"
                                            },
                                            "400": {
                                                "$ref": "#/errors/message"
                                            },
                                            "404": {
                                                "$ref": "#/errors/message"
                                            }
                                        }
                                    }
                                }
                            },
                            "instance": {
                                "type": "endpoint",
                                "url": "/api/businesses/<int:business_id>/managers/<manager_name>",
                                "description": "Instance of a manager at a business.",
                                "verbs": {
                                    "DELETE": {
                                        "accountTypes": [ "manager" ],
                                        "responses": {
                                            "204": {},
                                            "404": {
                                                "$ref": "#/errors/message"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "position": {
                        "type": "directory",
                        "contents": {
                            "collection": {
                                "type": "endpoint",
                                "url": "/api/businesses/<int:business_id>/positions",
                                "description": "Create a new position.",
                                "verbs": {
                                    "POST": {
                                        "accountTypes": [ "manager" ],
                                        "request": {
                                            "type": "object",
                                            "properties": {
                                                "name": {
                                                    "type": "string"
                                                },
                                                "default_pay": {
                                                    "type": "number",
                                                    "minimum": 0,
                                                    "exclusiveMinimum": true
                                                },
                                                "default_details": {
                                                    "type": "string"
                                                },
                                                "default_languages": {
                                                    "type": "array",
                                                    "items": {
                                                        "$ref": "#/definitions/language"
                                                    },
                                                    "minItems": 1
                                                }
                                            },
                                            "required": [
                                                "name",
                                                "default_pay",
                                                "default_details",
                                                "default_languages"
                                            ],
                                            "additionalProperties": false
                                        },
                                        "responses": {
                                            "200": {
                                                "$ref": "#/definitions/position"
                                            },
                                            "400": { "$ref": "#/errors/message" },
                                            "403": { "$ref": "#/errors/message" },
                                            "404": { "$ref": "#/errors/message" }
                                        }
                                    },
                                    "GET": {
                                        "accountTypes": [ "manager" ],
                                        "responses": {
                                            "200": {
                                                "type": "object",
                                                "properties": {
                                                    "positions": {
                                                        "type": "array",
                                                        "items": {
                                                            "$ref": "#/definitions/position"
                                                        }
                                                    }
                                                }
                                            },
                                            "403": { "$ref": "#/errors/message" },
                                            "404": { "$ref": "#/errors/message" }
                                        }
                                    }
                                }
                            },
                            "instance": {
                                "type": "endpoint",
                                "url": "/api/businesses/<int:business_id>/positions/<int:position_id>",
                                "description": "Instance of a single position within a business.",
                                "verbs": {
                                    "GET": {
                                        "accountTypes": [ "manager" ],
                                        "responses": {
                                            "200": {
                                                "$ref": "#/definitions/position"
                                            },
                                            "403": {
                                                "$ref": "#/errors/message"
                                            },
                                            "404": {
                                                "$ref": "#/errors/message"
                                            }
                                        }
                                    },
                                    "PATCH": {
                                        "accountTypes": [ "manager" ],
                                        "request": {
                                            "type": "object",
                                            "properties": {
                                                "name": {
                                                    "type": "string"
                                                }
                                            },
                                            "additionalProperties": false
                                        },
                                        "responses": {
                                            "204": {},
                                            "400": {
                                                "$ref": "#/errors/message"
                                            },
                                            "403": {
                                                "$ref": "#/errors/message"
                                            },
                                            "404": {
                                                "$ref": "#/errors/message"
                                            }
                                        }
                                    },
                                    "DELETE": {
                                        "accountTypes": [ "manager" ],
                                        "responses": {
                                            "204": {},
                                            "403": {
                                                "$ref": "#/errors/message"
                                            },
                                            "404": {
                                                "$ref": "#/errors/message"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "listing": {
                        "type": "directory",
                        "contents": {
                            "instance": {
                                "type": "endpoint",
                                "url":
                                "/api/businesses/<int:business_id>/listings/<int:listing_id>",
                                "description": "Detailed information about a listing.",
                                "verbs": {
                                    "GET": {
                                        "accountTypes": [ "employee", "manager" ],
                                        "responses": {
                                            "200": { "$ref": "#/definitions/listing" },
                                            "403": { "$ref": "#/errors/message" },
                                            "404": { "$ref": "#/errors/message" }
                                        }
                                    },
                                    "PATCH": {
                                        "accountTypes": [ "manager" ],
                                        "responses": {
                                            "204": {},
                                            "403": { "$ref": "#/errors/message" },
                                            "404": { "$ref": "#/errors/message" },
                                            "409": { "$ref": "#/errors/message" }
                                        }
                                    },
                                    "DELETE": {
                                        "accountTypes": [ "manager" ],
                                        "responses": {
                                            "204": {},
                                            "403": { "$ref": "#/errors/message" },
                                            "404": { "$ref": "#/errors/message" },
                                            "409": { "$ref": "#/errors/message" }
                                        }
                                    }
                                }
                            },
                            "apply": {
                                "type": "endpoint",
                                "description": "Apply to a job.",
                                "url": "/api/businesses/<int:business_id>/listings/<int:listing_id>/applicants",
                                "verbs": {
                                    "POST": {
                                        "accountTypes": [ "employee" ],
                                        "request": {
                                            "type": "object",
                                            "properties": {
                                                "name": { "type": "string" }
                                            },
                                            "required": [ "name" ],
                                            "additionalProperties": "false"
                                        },
                                        "responses": {
                                            "200": {
                                                "$ref": "#/definitions/listing"
                                            },
                                            "400": {
                                                "$ref": "#/errors/message"
                                            },
                                            "403": {
                                                "$ref": "#/errors/message"
                                            },
                                            "404": {
                                                "$ref": "#/errors/message"
                                            },
                                            "409": {
                                                "$ref": "#/errors/message"
                                            }
                                        }
                                    },
                                    "GET": {
                                        "accountTypes": [ "manager" ],
                                        "responses": {
                                            "200": {
                                                "type": "object",
                                                "properties": {
                                                    "applicants": {
                                                        "type": "array",
                                                        "items": {
                                                            "$ref": "#/definitions/employee"
                                                        }
                                                    }
                                                },
                                                "required": [ "applicants" ],
                                                "additionalProperties": false
                                            },
                                            "404": {
                                                "$ref": "#/errors/message"
                                            }
                                        }
                                    }
                                }
                            },
                            "employee": {
                                "type": "directory",
                                "contents": {
                                    "arrival": {
                                        "type": "endpoint",
                                        "url": "/api/businesses/<int:business_id>/listings/<int:listing_id>/employee/arrival",
                                        "description": "The arrival time of an employee.",
                                        "verbs": {
                                            "POST": {
                                                "accountTypes": [ "manager" ],
                                                "request": {
                                                    "type": "object",
                                                    "properties": {
                                                        "time": {
                                                            "$ref": "#/definitions/date_time"
                                                        }
                                                    },
                                                    "required": [ "time" ],
                                                    "additinalProperties": false
                                                },
                                                "responses": {
                                                    "200": {
                                                        "$ref": "#/definitions/listing"
                                                    },
                                                    "400": {
                                                        "$ref": "#/errors/message"
                                                    },
                                                    "403": {
                                                        "$ref": "#/errors/message"
                                                    },
                                                    "404": {
                                                        "$ref": "#/errors/message"
                                                    },
                                                    "409": {
                                                        "$ref": "#/errors/message"
                                                    }
                                                }
                                            }
                                        }
                                    },
                                    "departure": {
                                        "type": "endpoint",
                                        "url": "/api/businesses/<int:business_id>/listings/<int:listing_id>/employee/departure",
                                        "description": "The departure time of an employee.",
                                        "verbs": {
                                            "POST": {
                                                "accountTypes": [ "manager" ],
                                                "request": {
                                                    "type": "object",
                                                    "properties": {
                                                        "time": {
                                                            "$ref": "#/definitions/date_time"
                                                        }
                                                    },
                                                    "required": [ "time" ],
                                                    "additinalProperties": false
                                                },
                                                "responses": {
                                                    "200": {
                                                        "$ref": "#/definitions/listing"
                                                    },
                                                    "400": {
                                                        "$ref": "#/errors/message"
                                                    },
                                                    "403": {
                                                        "$ref": "#/errors/message"
                                                    },
                                                    "404": {
                                                        "$ref": "#/errors/message"
                                                    },
                                                    "409": {
                                                        "$ref": "#/errors/message"
                                                    }
                                                }
                                            }
                                        }
                                    },
                                    "approve": {
                                        "type": "endpoint",
                                        "url": "/api/businesses/<int:business_id>/listings/<int:listing_id>/employee",
                                        "description": "The employee selected for the job.",
                                        "verbs": {
                                            "POST": {
                                                "accountTypes": [ "manager" ],
                                                "request": {
                                                    "type": "object",
                                                    "properties": {
                                                        "name": {
                                                            "type": "string"
                                                        }
                                                    },
                                                    "required": [ "name" ],
                                                    "additionalProperties": false
                                                },
                                                "responses": {
                                                    "200": {
                                                        "$ref": "#/definitions/listing"
                                                    },
                                                    "400": {
                                                        "$ref": "#/errors/message"
                                                    },
                                                    "403": {
                                                        "$ref": "#/errors/message"
                                                    },
                                                    "404": {
                                                        "$ref": "#/errors/message"
                                                    },
                                                    "409": {
                                                        "$ref": "#/errors/message"
                                                    }
                                                }
                                            },
                                            "GET": {
                                                "accountTypes": [ "manager" ],
                                                "responses": {
                                                    "200": {
                                                        "$ref": "#/definitions/employee"
                                                    },
                                                    "403": {
                                                        "$ref": "#/errors/message"
                                                    },
                                                    "404": {
                                                        "$ref": "#/errors/message"
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            },
                            "collection": {
                                "type": "endpoint",
                                "url": "/api/businesses/<int:business_id>/listings",
                                "description": "Collection of listings.",
                                "verbs": {
                                    "GET": {
                                        "accountTypes": [ "employee", "manager" ],
                                        "responses": {
                                            "200": {
                                                "type": "object",
                                                "properties": {
                                                    "listings": {
                                                        "type": "array",
                                                        "items": {
                                                            "$ref": "#/definitions/listing"
                                                        }
                                                    }
                                                },
                                                "required": [ "properties" ],
                                                "additionalProperties": false
                                            },
                                            "403": { "$ref": "#/errors/message" },
                                            "404": { "$ref": "#/errors/message" }
                                        }
                                    },
                                    "POST": {
                                        "accountTypes": [ "manager" ],
                                        "request": {
                                            "type": "object",
                                            "properties": {
                                                "pay": {
                                                    "type": "number",
                                                    "minimum": 0
                                                },
                                                "duration": {
                                                    "type": "number",
                                                    "minimum": 0
                                                },
                                                "details": {
                                                    "type": "string"
                                                },
                                                "position": {
                                                    "$ref": "#/definitions/id"
                                                },
                                                "languages": {
                                                    "type": "array",
                                                    "items": {
                                                        "$ref": "#/definitions/language"
                                                    },
                                                    "minItems": 1
                                                }
                                            },
                                            "required": [
                                                "pay",
                                                "duration",
                                                "details",
                                                "position",
                                                "languages"
                                            ],
                                            "additionalProperties": false
                                        },
                                        "responses": {
                                            "202": {
                                                "$ref": "#/definitions/listing"
                                            },
                                            "403": { "$ref": "#/errors/message" },
                                            "404": { "$ref": "#/errors/message" }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    },
    "definitions": {
        "id": {
            "type": "integer",
            "minimum": 0
        },
        "named_id": {
            "type": "object",
            "description": "A convenience type for objects consisting of just an id and a name.",
            "properties": {
                "id": {
                    "$ref": "#/definitions/id"
                },
                "name": {
                    "type": "string"
                }
            },
            "required": [ "id", "name" ]
        },
        "gender": {
            "$ref": "#/definitions/named_id"
        },
        "company": {
            "$ref": "#/definitions/named_id"
        },
        "language": {
            "type": "object",
            "description": "Represents a spoken human language.",
            "properties": {
                "id": {
                    "$ref": "#/definitions/id"
                },
                "name": {
                    "type": "string"
                },
                "iso_name": {
                    "type": "string"
                }
            },
            "additionalProperties": false
        },
        "contact_info": {
            "type": "object",
            "description": "All information to use to contact someone.",
            "properties": {
                "phone_number": {
                    "type": "string",
                    "format": "phone-number"
                },
                "email_address": {
                    "type": "string",
                    "format": "email"
                }
            },
            "additionalProperties": false
        },
        "human": {
            "type": "object",
            "description": "Represents a physical person.",
            "properties": {
                "first_name": { "type": "string" },
                "last_name": { "type": "string" },
                "birth_date": { "$ref": "#/definitions/date_time" },
                "gender": { "$ref": "#/definitions/gender" },
                "contact_info": { "$ref": "#/definitions/contact_info" }
            },
            "additionalProperties": false
        },
        "employee": {
            "type": "object",
            "description": "A representation of an employee.",
            "properties": {
                "id": { "$ref": "#/definitions/id" },
                "username": { "type": "string" },
                "human": { "$ref": "#/definitions/human" },
                "is_verified": {
                    "type": "boolean"
                },
                "create_date": {
                    "type": "string",
                    "format": "date_time"
                },
                "home_location": { "$ref": "#/definitions/fixed_location" },
                "languages": {
                    "type": "array",
                    "minItems": 1,
                    "items": { "$ref": "#/definitions/language" }
                }
            },
            "additionalProperties": false
        },
        "longitude": {
            "type": "number",
            "minimum": -180,
            "maximum": 180
        },
        "latitude": {
            "type": "number",
            "minimum": -90,
            "maximum": 90
        },
        "location": {
            "type": "object",
            "properties": {
                "longitude": {
                    "$ref": "#/definitions/longitude"
                },
                "latitude": {
                    "$ref": "#/definitions/latitude"
                }
            },
            "required": [ "longitude", "latitude" ]
        },
        "country": {
            "$ref": "#/definitions/named_id"
        },
        "state": {
            "type": "object",
            "description": "A state, which is contained within a country.",
            "properties": {
                "id": {
                    "$ref": "#/definitions/id"
                },
                "name": {
                    "type": "string"
                },
                "country": {
                    "$ref": "#/definitions/country"
                }
            },
            "required": [ "name", "country" ]
        },
        "city": {
            "type": "object",
            "description": "A city, which is contained within a state.",
            "properties": {
                "id": {
                    "$ref": "#/definitions/id"
                },
                "name": {
                    "type": "string"
                },
                "state": {
                    "$ref": "#definitions/state"
                }
            },
            "required": [ "name", "state" ]
        },
        "fixed_location": {
            "type": "object",
            "description": "Represents a legally fixed location, with an address as well as geographical coordinates.",
            "properties": {
                "id": {
                    "type": "integer",
                    "minimum": 0
                },
                "address": {
                    "type": "string"
                },
                "city": {
                    "$ref": "#/definitions/city"
                },
                "postal_code": {
                    "type": "string",
                    "format": "postal-code"
                },
                "location": {
                    "$ref": "#/definitions/location"
                }
            }
        },
        "date_time": {
            "type": "string",
            "format": "date-time"
        },
        "business": {
            "type": "object",
            "properties": {
                "id": {
                    "$ref": "#/definitions/id"
                },
                "name": {
                    "type": "string"
                },
                "description": {
                    "type": "string"
                },
                "location": {
                    "$ref": "#/definitions/fixed_location"
                },
                "is_verified": {
                    "type": "boolean"
                },
                "company": {
                    "$ref": "#/definitions/company"
                },
                "contact_info": {
                    "$ref": "#/definitions/contact_info"
                },
                "languages": {
                    "type": "array",
                    "items": { "$ref": "#/definitions/language" }
                }
            },
            "additionalProperties": false,
            "required": [
                "id",
                "name",
                "description",
                "location",
                "is_verified"
            ]
        },
        "rating": {
            "type": [ "object", "null" ],
            "properties": {
                "value": {
                    "type": "number",
                    "minimum": 0,
                    "maximum": 1
                },
                "comment": {
                    "type": [ "string", "null" ]
                }
            },
            "required": [ "value", "comment" ],
            "additionalProperties": false
        },
        "listing": {
            "type": "object",
            "properties": {
                "id": { "$ref": "#/definitions/id" },
                "pay": {
                    "type": "number",
                    "minimum": 0
                },
                "details": { "type": "string" },
                "create_date": { "$ref": "#/definitions/date_time" },
                "arrival_date": { "$ref": "#/definitions/date_time" },
                "departure_date": { "$ref": "#/definitions/date_time" },
                "duration": {
                    "type": "number",
                    "minimum": 0
                },
                "position": { "$ref": "#/definitions/position" },
                "rating": {
                    "type": "object",
                    "properties": {
                        "ofEmployer": { "$ref": "#/definitions/rating" },
                        "ofEmployee": { "$ref": "#/definitions/rating" }
                    },
                    "additionalProperties": false
                },
                "business": { "$ref": "#/definitions/business" },
                "manager": { "$ref": "#/definitions/manager" },
                "employee": { "$ref": "#/definitions/employee" },
                "status": { "$ref": "#/definitions/job_status" },
                "languages": {
                    "type": "array",
                    "items": { "$ref": "#/definitions/language" },
                    "minItems": 1
                }
            },
            "additionalProperties": false,
            "required": [
                "id",
                "pay",
                "details",
                "create_date",
                "duration",
                "position",
                "business",
                "rating",
                "status",
                "languages"
            ]
        },
        "manager": {
            "type": "object",
            "properties": {
                "id": { "$ref": "#/definitions/id" },
                "username": { "type": "string" },
                "human": { "$ref": "#/definitions/human" }
            },
            "additionalProperties": false
        },
        "position": {
            "type": "object",
            "properties": {
                "id": { "$ref": "#/definitions/id" },
                "name": { "type": "string" },
                "create_date": { "$ref": "#/definitions/date_time" },
                "default_pay": {
                    "anyOf": [
                        { "type": "null" },
                        { "$ref": "#/definitions/salary" }
                    ]
                },
                "default_details": {
                    "type": [ "null", "string" ]
                },
                "default_languages": {
                    "type": [ "null", "array" ],
                    "items": {
                        "$ref": "#/definitions/language"
                    }
                }
            },
            "required": [ "id", "name", "create_date" ],
            "additionalProperties": false
        },
        "job_status": {
            "type": "object",
            "properties": {
                "id": { "$ref": "#/definitions/id" },
                "friendly_name": { "type": "string" },
                "name": { "$ref": "#/definitions/job_status_name" },
                "priority": { "type": "number" }
            }
        },
        "job_status_name": {
            "enum": [
                "pending",
                "submitted",
                "inProgress",
                "cancelled",
                "completed",
                "stale",
                "aborted"
            ]
        }
    },
    "errors": {
        "message": {
            "type": "object",
            "properties": {
                "message": {
                    "type": "string"
                }
            },
            "additionalProperties": true,
            "required": [ "message" ]
        }
    }
}
